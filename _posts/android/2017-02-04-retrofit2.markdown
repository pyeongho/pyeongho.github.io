---
layout: post
title: retrofit2 + okhttp3 네이버 기계번역 사용하기
category: andorid
comments: true
description: retrofit2,okhttp3 네이버 기계번역 사용하기
tags:
    - retrofit2
---



### retrofit2 를 이용한 통신 


#### 1. dependencies 추가 

```gradle
    compile 'com.squareup.okhttp3:okhttp:3.6.0'
    compile 'com.squareup.okhttp3:logging-interceptor:3.6.0'
    compile 'com.squareup.retrofit2:retrofit:2.1.0'

    compile 'com.squareup.retrofit2:converter-gson:2.1.0'
```


#### 2. 네이버 개발자 등록은 따로 기술 안합니다.
 - 개발자 등록
 - 애플리케이션 등록
 - 기계번역 API 사용 
 - 클라이언트 아이디, 시크릿 아이디  <- 이게 필요합니다.
 
#### 3. 개발자 등록후 우선 기계번역 API 사용 법을 확인해 보겠습니다.
- [기계번역 사용 java](https://developers.naver.com/docs/labs/translator)
- 위 링크를 따라 가면 java 항목의 예제가 있습니다. 
- 요약 하면 포스트 방식 사용
- 커스텀 헤더 필요
- 위 내용 정도만 알면 사용 가능 

#### 4. Retrofit 사용을 편하게 하기위한 클래스 작성(static)
 - 디버깅을 위한 http 로그 추가
 - 커스텀 헤더 추가
 - retrofit 생성 
 - <script src="https://gist.github.com/pyeongho/4d5b2c096baf1eefb76c39bf2f418cdc.js"></script>

#### 5. post body 를 넣을 인터페이스 클래스 생성 
- 네이버 기계번역에서 사용 하는 필드는 3개 입니다.
- source, target, text
- urlencoded 추가 한 인터페이스 클래스 입니다.
<script src="https://gist.github.com/pyeongho/ca8e9aa7513d1683f2740a6106cae249.js"></script>


#### 6. callback 상속 받기
- 그냥 사용해도 되지만 에러처리등을 편하게 사용하기 위함
- 필요한 클래스들 생성
<script src="https://gist.github.com/pyeongho/536acac03a5a3bb1e18db29b0677fda2.js"></script>

#### 7. 결과를 받을 클래스 생성 
- [json to java 파일 생성](http://www.jsonschema2pojo.org/)
- 다른 플러그인이 있다고 하지만 지금은 웹사이트를 이용하고 있습니다.
- 아래가 결과로 받을 json 형태 입니다. 
- 아내 내용으로 클래스 파일 3개를 만들어서 추가 하였습니다.
- 전체 코드 참고 

```json
{"message":
    {"@type":"response",
        "@service":"naverservice.labs.api",
        "@version":"1.0.0",
        "result":
            {"translatedText":"So glad to see you."}
    }
}
```

#### 8. MainActivity
 - api 인터페이스 사용을 위한 생성 
 - Call 생성 
 - 실행 
 - 한글을 영어로 바꾸는 함수 입니다.
 - 함수에 한글을 넘기면 영문으로 변환값이 출력 됩니다.
 <script src="https://gist.github.com/pyeongho/415d4b207338a8e49b6bbef69ae75389.js"></script>

#### 9. 전체 샘플 코드
 - 버터나이프 추가
 - EditText 에 한글 입력후 버튼을 누르면 영문이 나오는 간단한 샘플 입니다.
 - AppClient 의 클라이언트 아이디와 시크릿 아이디는 변경 해야합니다.
 - [github 링크 전체 파일](https://github.com/pyeongho/Retrofit2Sample)
 - 첫번째 리비전이 위 샘플 입니다.
